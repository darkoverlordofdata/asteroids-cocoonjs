"use strict";var Components,Entities,Game,Nodes,RenderSystem,SystemPriorities,res,__bind=function(a,b){return function(){return a.apply(b,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};res={fb_login:"res/images/fb-login.png",dialog_blue:"res/images/dialog-box.png",dialog_star:"res/images/black-dialog.png",button_blue:"res/images/standard-button-on.png",button_star:"res/images/black-button-on.png",background:"res/images/BackdropBlackLittleSparkBlack.png",leaderboard:"res/icons/b_Leaderboard.png",settings:"res/icons/b_Parameters.png",round:"res/images/round48.png",square:"res/images/square48.png"},Components=function(){var a,b,c,d,e,f;return{Display:a=function(){function a(a){this.sprite=a}return a.prototype.sprite=null,a}(),Gravity:b=function(){function a(a,b){this.x=a,this.y=b}return a.prototype.x=0,a.prototype.y=0,a}(),Hud:c=function(){function a(a,b,c,d,e){this.coins=a,this.meter=b,this.lives=c,this.labelCoin=d,this.labelMeter=e}return a.prototype.coins=0,a.prototype.meter=0,a.prototype.lives=3,a.prototype.labelCoin=null,a.prototype.labelMeter=null,a}(),Player:d=function(){function a(a,b,c,d,e){this.sprite=a,this.body=b,this.runningAction=c,this.jumpUpAction=d,this.jumpDownAction=e}return a.prototype.sprite=null,a.prototype.body=null,a.prototype.runningAction=null,a.prototype.jumpUpAction=null,a.prototype.jumpDownAction=null,a}(),TileMap:e=function(){function a(a,b,c,d){this.mapWidth=a,this.spriteSheet=b,this.map00=c,this.map01=d}return a.prototype.mapWidth=0,a.prototype.spriteSheet=null,a.prototype.map00=null,a.prototype.map01=null,a}(),Transform:f=function(){function a(a,b,c){this.x=null!=a?a:0,this.y=null!=b?b:0,this.alpha=null!=c?c:1}return a.prototype.x=0,a.prototype.y=0,a.prototype.alpha=0,a}()}}(),Nodes=function(){var a,b,c,d,e;return{HudNode:a=function(){function a(){}return a.prototype.hud=Components.Hud,a}(),RenderNode:d=function(){function a(){}return a.prototype.display=Components.Display,a.prototype.transform=Components.Transform,a}(),PhysicsNode:b=function(){function a(){}return a.prototype.physics=Components.Gravity,a}(),PlayerNode:c=function(){function a(){}return a.prototype.player=Components.Player,a}(),TileMapNode:e=function(){function a(){}return a.prototype.tilemap=Components.TileMap,a}()}}(),Entities=function(){function a(a){this.game=a,this.ash=this.game.ash,this.world=this.game.world}var b,c,d,e,f,g,h;return b=Components.Display,d=Components.Gravity,e=Components.Hud,f=Components.Player,g=Components.TileMap,h=Components.Transform,c=ash.core.Entity,a.prototype.ash=null,a.prototype.game=null,a.prototype.world=null,a.prototype.destroyEntity=function(a){this.ash.removeEntity(a)},a.prototype.createImage=function(a,d,e,f){var g,i;return null==f&&(f=1),i=new cc.Sprite(e),this.game.addChild(i),g=new c,g.add(new b(i)),g.add(new h(a,d,f)),this.ash.addEntity(g),g},a.prototype.createTileMap=function(a,b,d,e){var f,h,i,j,k;return f=new cc.TMXTiledMap(a),this.game.addChild(f),i=f.getContentSize().width,h=new cc.TMXTiledMap(b),h.setPosition(cc.p(i,0)),this.game.addChild(h),cc.spriteFrameCache.addSpriteFrames(d),j=new cc.SpriteBatchNode(e),this.game.addChild(j),k=new c,k.add(new g(i,j,f,h)),this.ash.addEntity(k),k},a.prototype.createPhysics=function(a,b){var e,f;return this.world.gravity=cp.v(a,b),f=new cp.SegmentShape(this.world.staticBody,cp.v(0,groundHeight),cp.v(4294967295,groundHeight),0),this.world.addStaticShape(f),e=new c,e.add(new d(a,b)),this.ash.addEntity(e),e},a.prototype.createRunner=function(a,b){var d,e,g,h,i,j,k,l,m,n,o,p;return cc.spriteFrameCache.addSpriteFrames(a),p=new cc.SpriteBatchNode(b),this.game.addChild(p),d=function(){var a,b;for(b=[],i=a=0;8>a;i=++a)b.push(cc.spriteFrameCache.getSpriteFrame("runner"+i+".png"));return b}(),e=new cc.Animation(d,.1),m=new cc.RepeatForever(new cc.Animate(e)),m.retain(),d=function(){var a,b;for(b=[],i=a=0;4>a;i=++a)b.push(cc.spriteFrameCache.getSpriteFrame("runnerJumpUp"+i+".png"));return b}(),e=new cc.Animation(d,.2),k=new cc.RepeatForever(new cc.Animate(e)),k.retain(),d=function(){var a,b;for(b=[],i=a=0;2>a;i=++a)b.push(cc.spriteFrameCache.getSpriteFrame("runnerJumpDown"+i+".png"));return b}(),e=new cc.Animation(d,.3),j=new cc.RepeatForever(new cc.Animate(e)),j.retain(),o=new cc.PhysicsSprite("#runner0.png"),h=o.getContentSize(),g=new cp.Body(1,cp.momentForBox(1,h.width,h.height)),g.p=cc.p(runnerStartX,groundHeight+h.height/2),g.applyImpulse(cp.v(150,0),cp.v(0,0)),this.world.addBody(g),n=new cp.BoxShape(g,h.width-14,h.height),this.world.addShape(n),o.setBody(g),o.runAction(m),p.addChild(o),l=new c,l.add(new f(o,g,m,k,j)),this.ash.addEntity(l),l},a.prototype.createHud=function(a,b,d){var f,g,h,i;return i=cc.director.getWinSize(),g=new cc.LabelTTF("Coins:0","Helvetica",20),g.setColor(cc.color(0,0,0)),g.setPosition(cc.p(70,i.height-20)),this.game.addChild(g),h=new cc.LabelTTF("0M","Helvetica",20),h.setPosition(cc.p(i.width-70,i.height-20)),this.game.addChild(h),f=new c,f.add(new e(a,b,d,g,h)),this.ash.addEntity(f),f},a}(),SystemPriorities=function(){function a(){}return a.preUpdate=1,a.update=2,a.move=3,a.resolveCollisions=4,a.stateMachines=5,a.render=6,a.animate=7,a}(),RenderSystem=function(a){function b(a){this.level=a,this.updateNode=__bind(this.updateNode,this),b.__super__.constructor.call(this,this.level.reg.nodes.RenderNode,this.updateNode)}return __extends(b,a),b.prototype.updateNode=function(a,b){var c,d,e;c=cc.director.getWinSize(),d=a.transform.x+c.width/2,e=a.transform.y+c.height/2,a.display.sprite.setPosition(cc.p(d,e))},b}(ash.tools.ListIteratingSystem),Game=cc.Layer.extend({ash:null,reg:null,entities:null,world:null,player:null,hud:null,ctor:function(){this._super(),this.ash=new ash.core.Engine,this.reg=new ash.ext.Helper(Components,Nodes),this.world=new cp.Space,this.entities=new Entities(this),this.entities.createImage(0,0,res.background),this.ash.addSystem(new RenderSystem(this),SystemPriorities.render),this.scheduleUpdate()},update:function(a){this.ash.update(a)}}),Game.scene=function(){var a;return a=new cc.Scene,a.addChild(new Game),a};